# Service Accounts

Service accounts are used by "bots" / software to access the k8s API

```bash
# Create a service account
k create sa <new-sa-name>

# View service accounts
k get sa

# Vew the token created by the SA
k describe sa <new-sa-name>
```

The token that is generated by the SA is what is used by the app to talk to the Kubernetes API  
The token is stored as a `secret`  
```sh
# For a service account called 'nats-operator'
k get secret nats-operator-token-gmv96 -o=jsonpath='{.data.token}' | base64 -d
```

We can then use the token to call the api with curl  
`curl https://<controller>:6443/api -insecure --header "Authorization: Bearer <token>"`

If the third party application is hosted on the kubernetes cluster that the secret is on then we can mount the service account token secret as a volume and use it in the pod

Every namespace has a `default` service account created   
By default, when a pod is created, the default service account is mounted automatically

The default service account has very limited permissions

To disable mounting the default service account, set 
`automountServiceAccountToken: false` in the pod `spec` section.

Use a custom service account in a pod spec:

```yaml
spec:
  container:
    # container stuff
  serviceAccount: service-account-name
```